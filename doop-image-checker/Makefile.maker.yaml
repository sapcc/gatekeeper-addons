# Configuration file for <https://github.com/sapcc/go-makefile-maker>

binaries:
  - name:        doop-image-checker
    fromPackage: .
    installTo:   bin/

vendoring:
  enabled: true

golangciLint:
  createConfig: true

verbatim: |
  DOCKER_REPO = keppel.eu-de-1.cloud.sap/ccloud/doop-image-checker
  DOCKER_TAG  = $(shell git describe --abbrev=10 --always --dirty)

  SUDO ?= $(shell if ! groups 2>/dev/null | grep -q docker; then echo sudo --preserve-env=DOCKER_BUILDKIT,DOCKER_CLI_EXPERIMENTAL,DOCKER_HOST,HOME,PWD; fi)
  push:
    $(SUDO) docker build -t $(DOCKER_REPO):$(DOCKER_TAG) .
    $(SUDO) docker push $(DOCKER_REPO):$(DOCKER_TAG)
